<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<style>
  body {
    font-family: Arial;
    padding: 20px;
  }
  button {
    padding: 10px 15px;
    font-size: 16px;
    margin: 10px 0;
    cursor: pointer;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
  }
  table, th, td {
    border: 1px solid #ccc;
  }
  th, td {
    padding: 8px;
  }
</style>
</head>
<body>

<h2>Admin Panel</h2>

<button id="resetNumberBtn">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ô‡∏±‡∏°‡πÄ‡∏ö‡∏≠‡∏£‡πå</button>
<p id="resetStatus"></p>
<button onclick="loadData()">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Sheet</button>

<div id="result"></div>

<script>
const SHEET_URL = "https://sheet.best/api/sheets/3718a053-334f-47be-b078-8467307e2bd6"; 

//----------------------------------------------------
// üßπ ‡∏õ‡∏∏‡πà‡∏°‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï lastNumber ‡∏ö‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ
//----------------------------------------------------
function resetNumber() {
  if (!confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) return;

  localStorage.removeItem("lastNumber");
  alert("‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!");
}

//----------------------------------------------------
// üìÑ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å sheet.best
//----------------------------------------------------
async function loadData() {
  document.getElementById("result").innerHTML = "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...";

  try {
    const res = await fetch(SHEET_URL);
    const data = await res.json();

    if (data.length === 0) {
      document.getElementById("result").innerHTML = "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
      return;
    }

    let html = "<table><tr><th>‡∏ä‡∏∑‡πà‡∏≠</th><th>‡πÄ‡∏•‡∏Ç‡∏£‡∏±‡∏ô</th><th>‡∏ß‡∏±‡∏ô‡πÄ‡∏ß‡∏•‡∏≤</th><th>Device</th><th>IP</th></tr>";

    data.forEach(row => {
      html += `
        <tr>
          <td>${row.name}</td>
          <td>${row.number}</td>
          <td>${row.date}</td>
          <td>${row.device}</td>
          <td>${row.ip}</td>
        </tr>
      `;
    });

    html += "</table>";

    document.getElementById("result").innerHTML = html;

  } catch (err) {
    console.error(err);
    document.getElementById("result").innerHTML = "‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
  }
}
</script>

</body>
</html>
